diff -rupN qtsingleapplication-2.6_1-opensource.old/src/qtlocalpeer.cpp qtsingleapplication-2.6_1-opensource/src/qtlocalpeer.cpp
--- qtsingleapplication-2.6_1-opensource.old/src/qtlocalpeer.cpp	2009-12-16 05:43:33.000000000 -0500
+++ qtsingleapplication-2.6_1-opensource/src/qtlocalpeer.cpp	2010-04-15 20:54:19.000000000 -0400
@@ -59,15 +59,6 @@ static PProcessIdToSessionId pProcessIdT
 #include <time.h>
 #endif
 
-namespace QtLP_Private {
-#include "qtlockedfile.cpp"
-#if defined(Q_OS_WIN)
-#include "qtlockedfile_win.cpp"
-#else
-#include "qtlockedfile_unix.cpp"
-#endif
-}
-
 const char* QtLocalPeer::ack = "ack";
 
 QtLocalPeer::QtLocalPeer(QObject* parent, const QString &appId)
@@ -118,7 +109,7 @@ bool QtLocalPeer::isClient()
     if (lockFile.isLocked())
         return false;
 
-    if (!lockFile.lock(QtLP_Private::QtLockedFile::WriteLock, false))
+    if (!lockFile.lock(QtLockedFile::WriteLock, false))
         return true;
 
     bool res = server->listen(socketName);
diff -rupN qtsingleapplication-2.6_1-opensource.old/src/qtlocalpeer.h qtsingleapplication-2.6_1-opensource/src/qtlocalpeer.h
--- qtsingleapplication-2.6_1-opensource.old/src/qtlocalpeer.h	2009-12-16 05:43:33.000000000 -0500
+++ qtsingleapplication-2.6_1-opensource/src/qtlocalpeer.h	2010-04-15 20:54:38.000000000 -0400
@@ -49,9 +49,7 @@
 #include <QtNetwork/QLocalSocket>
 #include <QtCore/QDir>
 
-namespace QtLP_Private {
 #include "qtlockedfile.h"
-}
 
 class QtLocalPeer : public QObject
 {
@@ -74,7 +72,7 @@ protected:
     QString id;
     QString socketName;
     QLocalServer* server;
-    QtLP_Private::QtLockedFile lockFile;
+    QtLockedFile lockFile;
 
 private:
     static const char* ack;
diff -rupN qtsingleapplication-2.6_1-opensource.old/src/qtsingleapplication.pri qtsingleapplication-2.6_1-opensource/src/qtsingleapplication.pri
--- qtsingleapplication-2.6_1-opensource.old/src/qtsingleapplication.pri	2009-12-16 05:43:33.000000000 -0500
+++ qtsingleapplication-2.6_1-opensource/src/qtsingleapplication.pri	2010-04-15 20:54:19.000000000 -0400
@@ -2,6 +2,7 @@ include(../common.pri)
 INCLUDEPATH += $$PWD
 DEPENDPATH += $$PWD
 QT *= network
+CONFIG *= qtlockedfile
 
 qtsingleapplication-uselib:!qtsingleapplication-buildlib {
     LIBS += -L$$QTSINGLEAPPLICATION_LIBDIR -l$$QTSINGLEAPPLICATION_LIBNAME
diff -rupN qtsingleapplication-2.6_1-opensource.old/src/qtsinglecoreapplication.pri qtsingleapplication-2.6_1-opensource/src/qtsinglecoreapplication.pri
--- qtsingleapplication-2.6_1-opensource.old/src/qtsinglecoreapplication.pri	2009-12-16 05:43:33.000000000 -0500
+++ qtsingleapplication-2.6_1-opensource/src/qtsinglecoreapplication.pri	2010-04-15 20:54:19.000000000 -0400
@@ -2,7 +2,7 @@ INCLUDEPATH	+= $$PWD
 DEPENDPATH      += $$PWD
 HEADERS		+= $$PWD/qtsinglecoreapplication.h $$PWD/qtlocalpeer.h
 SOURCES		+= $$PWD/qtsinglecoreapplication.cpp $$PWD/qtlocalpeer.cpp
-
+CONFIG *= qtlockedfile
 QT *= network
 
 win32:contains(TEMPLATE, lib):contains(CONFIG, shared) {
